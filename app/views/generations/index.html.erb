<div class="container">
  <div class="page-header">
    <%= link_to new_generation_path, class: 'btn btn-primary' do %>
      <span class="glyphicon glyphicon-plus"></span>
      Rajouter une génération
    <% end %>
  </div>
    
  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover">
      <thead>
        <tr>
          <th>Légume</th> 
          <% 52.times do %>
            <th></th>
          <% end %>  
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <%= content_tag_for(:tr, @generations) do |generation| %>
        <td><%= generation.legume.titre unless generation.legume.nil? %></td>
              <% semi = false 
                 plantation = false
                 recolte = false 
                 %>
              <% for i in 1..52 %>
                <% if generation.semi_from == i %>
                  <% semi = true %>
                  <td style="background-color:blue">SF</td>
                <% elsif generation.plantation == i %>
                  <td style="background-color:yellow">PL</td>
                  <% 
                    semi = false 
                    plantation = true
                  %>
                <% elsif generation.recolte == i %>
                  <td style="background-color:green">REC</td>
                  <% 
                    plantation = false
                    recolte = true unless generation.conservation_to == generation.recolte 
                  %>
                <% elsif generation.conservation_to == i %>
                  <td style="background-color:green">FIN</td>
                  <% 
                    recolte = false 
                  %>
                <% elsif semi %>
                  <td style="background-color:blue"></td>
                <% elsif plantation %>
                  <td style="background-color:yellow"></td>
                <% elsif recolte %>
                  <td style="background-color:green"></td>
                <% else %>
                  <td></td>
                <% end %>
              <% end %> 
          <td><%= link_to 'Show', generation %></td>
          <td><%= link_to 'Edit', edit_generation_path(generation) %></td>
          <td><%= link_to 'Destroy', generation, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tbody>
    </table>
  </div>
</div>